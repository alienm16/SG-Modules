# ====================================
# Locals pour Microsoft Graph Permissions
# ====================================

# Mapping complet des permissions Microsoft Graph Application
locals {
  # Toutes les permissions d'application Microsoft Graph disponibles
  graph_app_roles = {
    "AccessReview.Read.All"                                  = "d07a8cc0-3d51-4b77-b3b0-32704d1f69fa"
    "AccessReview.ReadWrite.All"                             = "ef5f7d5c-338f-44b0-86c3-351f46c8bb5f"
    "AccessReview.ReadWrite.Membership"                      = "18228521-a591-40f1-b215-5fad4488c117"
    "AdministrativeUnit.Read.All"                            = "134fd756-38ce-4afd-ba33-e9623dbe66c2"
    "AdministrativeUnit.ReadWrite.All"                       = "5b567255-7703-4780-807c-7be8301ae99b"
    "APIConnectors.Read.All"                                 = "b86848a7-d5b1-41eb-a9b4-54a4e6306e97"
    "APIConnectors.ReadWrite.All"                            = "1dfe531a-24a6-4f1b-80f4-7a0dc5a0a171"
    "AppCatalog.Read.All"                                    = "88e58d74-d3df-44f3-ad47-e89edf4472e4"
    "AppCatalog.ReadWrite.All"                               = "1ca167d5-1655-44a1-8adf-1414072e1ef9"
    "AppCatalog.Submit"                                      = "3db89e36-7fa6-4012-b281-85f3d9d9fd2e"
    "Application.Read.All"                                   = "9a5d68dd-52b0-4cc2-bd40-abcf44ac3a30"
    "Application.ReadWrite.All"                              = "1bfefb4e-e0b5-418b-a88f-73c46d2cc8e9"
    "Application.ReadWrite.OwnedBy"                          = "18a4783c-866b-4cc7-a460-3d5e5662c884"
    "AuditLog.Read.All"                                      = "b0afded3-3588-46d8-8b3d-9842eff778da"
    "BitlockerKey.Read.All"                                  = "57f1cf28-c0c4-4ec3-9a30-19a2eaaf2f6e"
    "BitlockerKey.ReadBasic.All"                             = "f690d423-6b29-4d04-98c6-694c42282419"
    "Calendars.Read"                                         = "798ee544-9d2d-430c-a058-570e29e34338"
    "Calendars.ReadWrite"                                    = "ef54d2bf-783f-4e0f-bca1-3210c0444d99"
    "Channel.Create"                                         = "f3a65bd4-b703-46df-8f7e-0174fea562aa"
    "Channel.Delete.All"                                     = "6a118a39-1227-45d4-af0c-ea7b40d210bc"
    "Channel.ReadBasic.All"                                  = "59a6b24b-4225-4393-8165-ebaec5f55d7a"
    "ChannelMember.Read.All"                                 = "3b55498e-47ec-484f-8136-9013221c06a9"
    "ChannelMember.ReadWrite.All"                            = "35930dcf-aceb-4bd1-b99a-8ffed403c974"
    "ChannelMessage.Read.All"                                = "7b2449af-6ccd-4f4d-9f78-e550c193f0d1"
    "ChannelSettings.Read.All"                               = "c97b873f-f59f-49aa-8a0e-52b32d762124"
    "ChannelSettings.ReadWrite.All"                          = "243cded2-bd16-4fd6-a953-ff8177894c3d"
    "Chat.Create"                                            = "d9c48af6-9ad9-47ad-82c3-63757137b9af"
    "Chat.Read.All"                                          = "6b7d71aa-70aa-4810-a8d9-5d9fb2830017"
    "Chat.ReadBasic.All"                                     = "b9bb2381-47a4-46cd-aafb-00cb12f68504"
    "Chat.ReadWrite.All"                                     = "9ff7295e-131b-4d94-90e1-69fde507ac11"
    "ChatMember.Read.All"                                    = "a3410be2-8e48-4f32-8454-c29a7465209d"
    "ChatMember.ReadWrite.All"                               = "57257249-34ce-4810-a8a2-a03adf0c5693"
    "ChatMessage.Read.All"                                   = "b9bb2381-47a4-46cd-aafb-00cb12f68504"
    "Contacts.Read"                                          = "089fe4d0-434a-44c5-8827-41ba8a0b17f5"
    "Contacts.ReadWrite"                                     = "6918b873-d17a-4dc1-b314-35f528134491"
    "Device.Read.All"                                        = "7438b122-aefc-4978-80ed-43db9fcc7715"
    "Device.ReadWrite.All"                                   = "1138cb37-bd11-4084-a2b7-9f71582aeddb"
    "DeviceManagementApps.Read.All"                          = "7a6ee1e7-141e-4cec-ae74-d9db155731ff"
    "DeviceManagementApps.ReadWrite.All"                     = "78145de6-330d-4800-a6ce-494ff2d33d07"
    "DeviceManagementConfiguration.Read.All"                 = "dc377aa6-52d8-4e23-b271-2a7ae04cedf3"
    "DeviceManagementConfiguration.ReadWrite.All"            = "9241abd9-d0e6-425a-bd4f-47ba86e767a4"
    "DeviceManagementManagedDevices.Read.All"                = "2f51be20-0bb4-4fed-bf7b-db946066c75e"
    "DeviceManagementManagedDevices.ReadWrite.All"           = "243333ab-4d21-40cb-a475-36241daa0842"
    "DeviceManagementRBAC.Read.All"                          = "58ca0d9a-1575-47e1-a3cb-007caf908b8b"
    "DeviceManagementRBAC.ReadWrite.All"                     = "0c5e8a55-87a6-4556-93ab-adc52c4d862d"
    "DeviceManagementServiceConfig.Read.All"                 = "06a5fe6d-c49d-46a7-b082-56b1b14103c7"
    "DeviceManagementServiceConfig.ReadWrite.All"            = "5ac13192-7ace-4fcf-b828-1a26f28068ee"
    "Directory.Read.All"                                     = "7ab1d382-f21e-4acd-a863-ba3e13f7da61"
    "Directory.ReadWrite.All"                                = "19dbc75e-c2e2-444c-a770-ec69d8559fc7"
    "Domain.Read.All"                                        = "dbb9058a-0e50-45d7-ae91-66909b5d4664"
    "Domain.ReadWrite.All"                                   = "7e05723c-0bb0-42da-be95-ae9f08a6e53c"
    "EduAdministration.Read.All"                             = "7c9db06a-ec2d-4e7b-a592-5a1e30992566"
    "EduAdministration.ReadWrite.All"                        = "9bc431c3-b8bc-4a8d-a219-40f10f92eff6"
    "EduAssignments.Read.All"                                = "4c37e1b6-35a1-43bf-926a-6f30f2cdf585"
    "EduAssignments.ReadWrite.All"                           = "0d22204b-6cad-4dd0-8362-3e3f2ae699d9"
    "EduRoster.Read.All"                                     = "e0ac9e1b-cb65-4fc5-87c5-1a8bc181f648"
    "EduRoster.ReadWrite.All"                                = "d1808e82-ce13-47af-ae0d-f9b254e6d58a"
    "EntitlementManagement.Read.All"                         = "c74fd47d-ed3c-45c3-9a9e-b8676de685d2"
    "EntitlementManagement.ReadWrite.All"                    = "9acd699f-1e81-4958-b001-93b1d2506e19"
    "EventListener.Read.All"                                 = "0edf5e9e-4ce8-468a-8432-d08631d18c43"
    "EventListener.ReadWrite.All"                            = "0edf5e9e-4ce8-468a-8432-d08631d18c43"
    "Files.Read.All"                                         = "01d4889c-1287-42c6-ac1f-5d1e02578ef6"
    "Files.ReadWrite.All"                                    = "75359482-378d-4052-8f01-80520e7db3cd"
    "Group.Read.All"                                         = "5b567255-7703-4780-807c-7be8301ae99b"
    "Group.ReadWrite.All"                                    = "62a82d76-70ea-41e2-9197-370581804d09"
    "GroupMember.Read.All"                                   = "98830695-27a2-44f7-8c18-0c3ebc9698f6"
    "GroupMember.ReadWrite.All"                              = "dbaae8cf-10b5-4b86-a4a1-f871c94c6695"
    "IdentityProvider.Read.All"                              = "e321f0bb-e7f7-481e-bb28-e3b0b32d4bd0"
    "IdentityProvider.ReadWrite.All"                         = "90db2b9a-d928-4d33-a4dd-8442ae3d41e4"
    "IdentityRiskEvent.Read.All"                             = "6e472fd1-ad78-48da-a0f0-97ab2c6b769e"
    "IdentityRiskyUser.Read.All"                             = "dc5007c0-2d7d-4c42-879c-2dab87571379"
    "IdentityRiskyUser.ReadWrite.All"                        = "656f6061-f9fe-4807-9708-6a2e0934df76"
    "IdentityUserFlow.Read.All"                              = "1b0c317f-dd31-4305-9932-259a8b6e8099"
    "IdentityUserFlow.ReadWrite.All"                         = "65319a09-a2be-469d-8782-f6b07debf789"
    "Mail.Read"                                              = "810c84a8-4a9e-49e6-bf7d-12d183f40d01"
    "Mail.ReadWrite"                                         = "e2a3a72e-5f79-4c64-b1b1-878b674786c9"
    "Mail.Send"                                              = "b633e1c5-b582-4048-a93e-9f11b44c7e96"
    "MailboxSettings.Read"                                   = "40f97065-369a-49f4-947c-6a255697ae91"
    "MailboxSettings.ReadWrite"                              = "6931bccd-447a-43d1-b442-00a195474933"
    "Member.Read.Hidden"                                     = "658aa5d8-239f-45c4-aa12-864f4fc7e490"
    "Notes.Read.All"                                         = "3aeca27b-ee3a-4c2b-8ded-80376e2134a4"
    "Notes.ReadWrite.All"                                    = "0c458cef-11f3-48c2-a568-c66751c238c0"
    "OnlineMeetings.Read.All"                                = "c1684f21-1984-47fa-9d61-2dc8c296bb70"
    "OnlineMeetings.ReadWrite.All"                           = "b8bb2037-6e08-44ac-a4ea-4674e010e2a4"
    "Organization.Read.All"                                  = "498476ce-e0fe-48b0-b801-37ba7e2685c6"
    "Organization.ReadWrite.All"                             = "292d869f-3427-49a8-9dab-8c70152b74e9"
    "People.Read.All"                                        = "b89f9189-71a5-4e70-b041-9887f0bc7e4a"
    "Policy.Read.All"                                        = "246dd0d5-5bd0-4def-940b-0421030a5b68"
    "Policy.ReadWrite.AuthenticationFlows"                   = "25f85f3c-f66c-4205-8cd5-de92dd7f0cec"
    "Policy.ReadWrite.AuthenticationMethod"                  = "29c18626-4985-4dcd-85c0-193eef327366"
    "Policy.ReadWrite.Authorization"                         = "fb221be6-99f2-473f-bd32-01c6a0e9ca3b"
    "Policy.ReadWrite.ConditionalAccess"                     = "01c0a623-fc9b-48e9-b794-0756f8e8f067"
    "Policy.ReadWrite.CrossTenantAccess"                     = "338163d7-f101-4c92-94ba-ca46fe52447c"
    "Policy.ReadWrite.FeatureRollout"                        = "92a38652-f13b-4875-bc77-6e1dbb63e1b2"
    "Policy.ReadWrite.PermissionGrant"                       = "a402ca1c-2696-4531-972d-6e5ee4aa11ea"
    "Policy.ReadWrite.TrustFramework"                        = "79a677f7-b79d-40d0-a36a-3e6f8688dd7a"
    "PrivilegedAccess.Read.AzureAD"                          = "4cdc2547-9148-4295-8d11-be0db1391d6b"
    "PrivilegedAccess.Read.AzureADGroup"                     = "01e37dc9-c035-40bd-b438-b2879c4870a6"
    "PrivilegedAccess.Read.AzureResources"                   = "5df6fe86-1be0-44eb-b916-7bd443a71236"
    "PrivilegedAccess.ReadWrite.AzureAD"                     = "854d9ab1-6657-4ec8-be45-823027bcd009"
    "PrivilegedAccess.ReadWrite.AzureADGroup"                = "2f6817f8-7b12-4f0f-bc18-eeaf60705a9e"
    "PrivilegedAccess.ReadWrite.AzureResources"              = "6f9d5abc-2db6-400b-a267-7de22a40fb87"
    "PrivilegedAssignmentSchedule.Read.AzureADGroup"         = "d329c81c-20ad-4772-abf9-3f6fdb7e5988"
    "PrivilegedAssignmentSchedule.ReadWrite.AzureADGroup"    = "eb0788c2-6d4e-4658-8c9e-c0fb8053f03d"
    "PrivilegedEligibilitySchedule.Read.AzureADGroup"        = "ba974594-d163-484e-ba39-c330d5897667"
    "PrivilegedEligibilitySchedule.ReadWrite.AzureADGroup"   = "618e26b9-446c-4a29-9936-86b9b9d4787e"
    "Reports.Read.All"                                       = "230c1aed-a721-4c5d-9cb4-a90514e508ef"
    "RoleManagement.Read.All"                                = "c7fbd983-d9aa-4fa7-84b8-17382c103bc4"
    "RoleManagement.Read.Directory"                          = "483bed4a-2ad3-4361-a73b-c83ccdbdc53c"
    "RoleManagement.ReadWrite.Directory"                     = "9e3f62cf-ca93-4989-b6ce-bf83c28f9fe8"
    "RoleManagementPolicy.Read.AzureADGroup"                 = "7e02d99d-d7c6-4c39-8401-8a36c555380c"
    "RoleManagementPolicy.Read.Directory"                    = "3de2cdbe-0ff5-47d5-bdee-7f45b4749ead"
    "RoleManagementPolicy.ReadWrite.AzureADGroup"            = "0da165c7-3f15-4236-b733-c0b0f6abe41d"
    "RoleManagementPolicy.ReadWrite.Directory"               = "31e08e0a-d3f7-4ca2-ac39-7343fb83e8ad"
    "Schedule.Read.All"                                      = "7b2ebf90-d836-437f-b90d-7b62722c4456"
    "Schedule.ReadWrite.All"                                 = "b7760610-0545-4e8a-9ec3-cce9e63db01c"
    "SecurityEvents.Read.All"                                = "bf394140-e372-4bf9-a898-299cfc7564e5"
    "SecurityEvents.ReadWrite.All"                           = "d903a879-88e0-4c09-b0c9-82f6a1333f84"
    "ServiceHealth.Read.All"                                 = "79c261e0-fe76-4144-aad5-bdc68fbe4037"
    "ServiceMessage.Read.All"                                = "1b620472-6534-4fe6-9df2-4680e8aa28ec"
    "Sites.FullControl.All"                                  = "a82116e5-55eb-4c41-a434-62fe8a61c773"
    "Sites.Manage.All"                                       = "0c0bf378-bf22-4481-8f81-9e89a9b4960a"
    "Sites.Read.All"                                         = "332a536c-c7ef-4017-ab91-336970924f0d"
    "Sites.ReadWrite.All"                                    = "9492366f-7969-46a4-8d15-ed1a20078fff"
    "Tasks.Read.All"                                         = "f10e1f91-74ed-437f-a6fd-d6ae88e26c1f"
    "Tasks.ReadWrite.All"                                    = "44e666d1-d276-445b-a5fc-8815eeb81d55"
    "Team.Create"                                            = "23fc2474-f741-46ce-8465-674744c5c361"
    "Team.ReadBasic.All"                                     = "2280dda6-0bfd-44ee-a2f4-cb867cfc4c1e"
    "TeamMember.Read.All"                                    = "660b7406-55f1-41ca-a0ed-0b035e182f3e"
    "TeamMember.ReadWrite.All"                               = "0121dc95-1b9f-4aed-8bac-58c5ac466691"
    "TeamsActivity.Read.All"                                 = "70dec828-f620-4914-aa83-a29117306807"
    "TeamsActivity.Send"                                     = "a267235f-af13-44dc-8385-c1dc93023186"
    "TeamsApp.Read.All"                                      = "9127ba42-f79f-43b4-92eb-8f18a67f6c1c"
    "TeamsApp.ReadWrite.All"                                 = "eb6b3d76-ed75-4be6-ac36-158d04c0a555"
    "TeamsAppInstallation.ReadForTeam.All"                   = "1f615aea-6bf9-4b05-84bd-46388e138537"
    "TeamsAppInstallation.ReadForUser.All"                   = "9127ba42-f79f-43b4-92eb-8f18a67f6c1c"
    "TeamsAppInstallation.ReadWriteForTeam.All"              = "5dad17ba-f6cc-4954-a5a2-a0dcc95154f0"
    "TeamsAppInstallation.ReadWriteForUser.All"              = "74ef0291-ca83-4d02-8c7e-d2391e6a444f"
    "TeamsAppInstallation.ReadWriteSelfForTeam.All"          = "9127ba42-f79f-43b4-92eb-8f18a67f6c1c"
    "TeamsAppInstallation.ReadWriteSelfForUser.All"          = "908de74d-f8b2-4d6b-a9ed-2a17b3b78179"
    "TeamSettings.Read.All"                                  = "242607bd-1d2c-432c-82eb-bdb27baa23ab"
    "TeamSettings.ReadWrite.All"                             = "bdd80a03-d9bc-451d-b7c4-ce7c63fe3c8f"
    "TeamsTab.Create"                                        = "49981c42-fd7b-4530-be03-e77b21aed25e"
    "TeamsTab.Read.All"                                      = "46890524-499a-4bb2-ad64-1476b4f3e1cf"
    "TeamsTab.ReadWrite.All"                                 = "a9ff19c2-f369-4a95-9a25-ba9d460efc8e"
    "TeamsTab.ReadWriteForTeam.All"                          = "6163d4f4-fbf8-43da-a7b4-060fe85ed148"
    "TermStore.Read.All"                                     = "297f747b-0005-475b-8fef-c890f5152b38"
    "TermStore.ReadWrite.All"                                = "6c37c71d-f50f-4bff-8fd3-8a41da390140"
    "ThreatAssessment.Read.All"                              = "f8f035bb-2cce-47fb-8bf5-7baf3ecbee48"
    "ThreatIndicators.ReadWrite.OwnedBy"                     = "21792b6c-c986-4ffc-85de-df9da54b52fa"
    "TrustFrameworkKeySet.Read.All"                          = "fff194f1-7dce-4428-8301-1badb5518201"
    "TrustFrameworkKeySet.ReadWrite.All"                     = "4a771c9a-1cf2-4609-b88e-3d3e02d539cd"
    "User.Export.All"                                        = "405a51b5-8d8d-430b-9842-8be4b0e9f324"
    "User.Invite.All"                                        = "09850681-111b-4a89-9bed-3f2cae46d706"
    "User.ManageIdentities.All"                              = "c529cfca-c91b-489c-af2b-d92990b66ce6"
    "User.Read.All"                                          = "df021288-bdef-4463-88db-98f22de89214"
    "User.ReadWrite.All"                                     = "741f803b-c850-494e-b5df-cde7c675a1ca"
    "UserAuthenticationMethod.Read.All"                      = "38d9df27-64da-44fd-b7c5-a6fbac20248f"
    "UserAuthenticationMethod.ReadWrite.All"                 = "50483e42-d915-4231-9639-7fdb7fd190e5"
  }

  # Mapper les noms de permissions aux objets avec ID et type
  required_application_permissions = [
    for permission in var.graph_application_permissions : {
      id   = local.graph_app_roles[permission]
      type = "Role" # "Role" pour Application permissions
    }
  ]
}